{{ $jsFiles := resources.Match "js/*.js" }}

{{ $bundle := $jsFiles | resources.Concat "js/bundle.js" }}

{{- if eq hugo.Environment "development" }}
  {{- $opts := dict "sourcemap" "inline" }}
  {{- with $bundle | js.Build $opts }}
<script src="{{ .RelPermalink }}" defer></script>
  {{- end }}
{{- else }}
  {{- $opts := dict "minify" true }}
  {{- with $bundle | js.Build $opts | fingerprint }}
<script src="{{ .RelPermalink }}" integrity="{{ .Data.Integrity }}" crossorigin="anonymous" defer></script>
  {{- end }}
{{- end }}

